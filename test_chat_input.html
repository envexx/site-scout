<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Input Test - Site Scout AI</title>
    <link rel="stylesheet" href="src/popup/style.css">
    <style>
        body {
            padding: 20px;
            background: #0a0a0f;
            font-family: 'Inter', sans-serif;
            color: white;
        }
        .test-container {
            max-width: 400px;
            margin: 0 auto;
            background: #1a1a2e;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .test-title {
            text-align: center;
            margin-bottom: 20px;
            color: #ffffff;
            font-size: 18px;
        }
        .test-info {
            background: rgba(79, 172, 254, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.2);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #a0a9c0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="test-title">Chat Input Test - Site Scout AI</h1>
        
        <div class="test-info">
            <strong>Test Instructions:</strong><br>
            1. Type in the input field - send button should enable<br>
            2. Click hint pills - should insert text and auto-send<br>
            3. Check colors match extension theme<br>
            4. Verify responsive design
        </div>
        
        <!-- Chat Input Container -->
        <div class="chat-input-container">
            <div class="floating-elements"></div>
            
            <div class="input-wrapper">
                <div class="textarea-container">
                    <textarea id="questionInput" 
                              placeholder="Ask something about this page..." 
                              maxlength="500"
                              rows="1"></textarea>
                    <div class="char-counter">
                        <span id="charCount">0</span>/500
                    </div>
                </div>
                <button id="sendQuestionBtn" class="send-btn" disabled>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22,2 15,22 11,13 2,9"></polygon>
                    </svg>
                </button>
            </div>
            
            <div class="input-hints">
                <div class="hint-pill" onclick="insertHint('What is this page about?')">What is this about?</div>
                <div class="hint-pill" onclick="insertHint('Summarize the main points')">Summarize</div>
                <div class="hint-pill" onclick="insertHint('What are the key features?')">Key features</div>
                <div class="hint-pill" onclick="insertHint('How does this work?')">How it works</div>
            </div>
        </div>
        
        <div style="margin-top: 20px; text-align: center; color: #a0a9c0; font-size: 14px;">
            <p>âœ… Chat input styling test completed!</p>
            <p>Colors should match extension theme and hint pills should work.</p>
        </div>
    </div>

    <script>
        // Enhanced chat input functionality
        document.addEventListener('DOMContentLoaded', function() {
            const questionInput = document.getElementById('questionInput');
            const sendBtn = document.getElementById('sendQuestionBtn');
            const charCount = document.getElementById('charCount');
            
            if (questionInput && sendBtn && charCount) {
                // Auto-resize textarea
                questionInput.addEventListener('input', function() {
                    this.style.height = 'auto';
                    this.style.height = Math.min(this.scrollHeight, 100) + 'px';
                    
                    // Update character count
                    const count = this.value.length;
                    charCount.textContent = count;
                    
                    // Enable/disable send button
                    sendBtn.disabled = this.value.trim().length === 0;
                    
                    // Color change for character limit
                    if (count > 450) {
                        charCount.style.color = '#ef4444';
                    } else if (count > 400) {
                        charCount.style.color = '#f59e0b';
                    } else {
                        charCount.style.color = '#9ca3af';
                    }
                });
                
                // Send button click
                sendBtn.addEventListener('click', function() {
                    if (questionInput.value.trim()) {
                        console.log('Sending message:', questionInput.value);
                        // Clear input after sending
                        questionInput.value = '';
                        questionInput.style.height = 'auto';
                        sendBtn.disabled = true;
                        charCount.textContent = '0';
                    }
                });
                
                // Enter key to send (Shift+Enter for new line)
                questionInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        if (this.value.trim()) {
                            sendBtn.click();
                        }
                    }
                });
                
                // Focus management
                questionInput.addEventListener('focus', function() {
                    this.parentElement.parentElement.style.transform = 'translateY(-2px)';
                });
                
                questionInput.addEventListener('blur', function() {
                    if (!this.value) {
                        this.parentElement.parentElement.style.transform = 'translateY(0)';
                    }
                });
                
                // Ensure send button is properly enabled/disabled
                function updateSendButtonState() {
                    if (sendBtn && questionInput) {
                        const hasText = questionInput.value.trim().length > 0;
                        sendBtn.disabled = !hasText;
                        
                        // Visual feedback
                        if (hasText) {
                            sendBtn.style.opacity = '1';
                            sendBtn.style.cursor = 'pointer';
                        } else {
                            sendBtn.style.opacity = '0.6';
                            sendBtn.style.cursor = 'not-allowed';
                        }
                    }
                }
                
                // Update button state on input
                questionInput.addEventListener('input', updateSendButtonState);
                
                // Initial state
                updateSendButtonState();
            }
        });
        
        // Insert hint function and auto-send
        function insertHint(text) {
            const questionInput = document.getElementById('questionInput');
            const sendBtn = document.getElementById('sendQuestionBtn');
            
            if (questionInput && sendBtn) {
                // Insert the hint text
                questionInput.value = text;
                questionInput.focus();
                
                // Trigger input event to update character count and enable button
                questionInput.dispatchEvent(new Event('input'));
                
                // Visual feedback - add clicked class
                const clickedPill = event.target;
                if (clickedPill) {
                    clickedPill.classList.add('clicked');
                    setTimeout(() => clickedPill.classList.remove('clicked'), 200);
                }
                
                // Auto-send after a short delay to show the hint was inserted
                setTimeout(() => {
                    if (sendBtn && !sendBtn.disabled) {
                        sendBtn.click();
                    }
                }, 500);
            }
        }
    </script>
</body>
</html>
